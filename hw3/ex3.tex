\documentclass[12pt]{article}
\usepackage{amsmath}


\newcommand\tab[1][1cm]{\hspace*{#1}}

\linespread{1.3}


\title{Machine Learning from Data: Homework 3 - Probabilities}
\author{227367455 and 323081950}

\begin{document}

\maketitle

\begin{center}
\section*{Question 1}

\end{center}
Given a random sample $\lbrace x_1 , x_2 , ... , x_n \rbrace$, derive the
 maximum likelihood estimator $\hat{p}$ of the Binomial distribution. \\

\begin{center}
$ B(x,p) = \binom{n}{x} p^x (1-p)^{n-x}$ 
\end{center} 

We first want to calculate the likelihood: \\

$ L = P(x_1,...x_n \mid p) =  \prod^{n}_{i = 1} P(x_i \mid p) $ \\

$ =  \prod^{n}_{i = 1} \binom{n}{x_i} p^{x_i} (1-p)^{1-x_i} $ \\

$ = \prod^{n}_{i = 1} p^{x_i} (1-p)^{1-x_i}  \prod^{n}_{i = 1} \binom{n}{x_i}  $ \\

$ = p^{\sum^{n}_{i = 1} x_i} (1-p)^{n - \sum^{n}_{i = 1} x_i}  \prod^{n}_{i = 1} \binom{n}{x_i} $ \\

\newpage

From the likelihood we calculate the log-likelihood: \\

$ ln(L) = ln(p^{\sum^{n}_{i = 1} x_i} (1-p)^{n - \sum^{n}_{i = 1} x_i}  \prod^{n}_{i = 1} \binom{n}{x_i}) $ \\

$ =  ln(p^{\sum^{n}_{i = 1} x_i}) + ln( (1-p)^{n - \sum^{n}_{i = 1} x_i}) + ln(\prod^{n}_{i = 1} \binom{n}{x_i})  $ \\

$ = ln(p) \sum^{n}_{i = 1} x_i + ln( 1-p) (n - \sum^{n}_{i = 1} x_i) +  \sum^{n}_{i = 1} ln(\binom{n}{x_i})$ \\

We will take the derivative in respect to $p$ our given value: \\

$\dfrac{\partial[ln(L) ]}{\partial p} = \dfrac{\partial[ ln(p) \sum^{n}_{i = 1} x_i  ]}{\partial p} + \dfrac{\partial[ ln( 1-p) (n - \sum^{n}_{i = 1} x_i)]}{\partial p} $ \\ 

$ = \dfrac{\sum^{n}_{i = 1} x_i  }{p} - \dfrac{ (n - \sum^{n}_{i = 1} x_i) }{1 - p} $ \\

To find the a maximum we set the derivative to 0 obtaining: \\

$  \dfrac{\sum^{n}_{i = 1} x_i  }{\hat{p}} - \dfrac{ n - \sum^{n}_{i = 1} x_i }{1 - \hat{p}} = 0 $ \\

$ (1-\hat{p})\sum^{n}_{i = 1} x_i - \hat{p} (n - \sum^{n}_{i = 1} x_i) = 0 $ \\

$ \sum^{n}_{i = 1} x_i  - \hat{p}\sum^{n}_{i = 1} x_i - \hat{p}n + \hat{p} \sum^{n}_{i = 1} x_i) = 0 $ \\

$ \sum^{n}_{i = 1} x_i  - \hat{p}n + = 0 $ \\

$ \hat{p}n = \sum^{n}_{i = 1} x_i  $ \\

Thus we obtain: 

\begin{center}
$ \hat{p} = \dfrac{\sum^{n}_{i = 1} x_i}{n} $
\end{center}



\newpage
\begin{center}
\section*{Question 2}
\end{center}

\tab A student wants to know her chances to pass and fail an exam if she studies and if she doesn't study.  From last year's results, she sees that $P(Pass) = 60\%$. 
She also found out that 
$P(Studied \mid Pass) = 95\%$, 
$P(Studied \mid Failed) = 60\%$. 
You can assume that every student either studied or didn't study, and either passed or failed.\\

$P(Failed) = 1 -  P(Pass) = 1 - 0.6 = 0.4 $ \\

$P(Studied) = P(Studied \mid Pass) P(Pass) +  P(Studied \mid Failed) P(Failed)$

$= 0.95 \cdot 0.6 + 0.6 \cdot 0.4= 0.81$ \\

$P(\overline{Studied}) = 1 - P(Studied) = 1 - 0.81 = 0.19 $\\

$P(\overline{Studied} \mid Pass) = 1 - P(Studied \mid Pass) = 1 - 0.95 = 0.05$,


\subsection*{a.}
What is her probability of passing the exam if she studies?\\

$P(Pass| Studied) = \dfrac{P(Studied \mid Pass)P(Pass)}{P(Studied)}$ 
$ =  \dfrac{0.95 \cdot 0.6}{0.81} = 0.7037 $

\subsection*{b.}

What is her probability of passing if she doesn't study? \\

$P(Pass \mid \overline{Studied}) = \dfrac{P(\overline{Studied} \mid Pass)P(Pass)}{P(\overline{Studied})}$
$ =  \dfrac{0.05 \cdot 0.6}{0.19} = 0.1578 $

\newpage

\begin{center}
\section*{Question 3}
\end{center}
Find 3 random variables $X, Y, C$ such that:\\


a) $X \perp Y \mid C $\\

b) $X$ and $Y$ are not independent \\

c) $X, Y$ are integers such that $3 \leq X, Y \leq 9$ and $C$ is binary.\\

d) The following conditions hold:

\tab i.  $ P(1 \leq X, \leq 5) = 0.4$

\tab ii.  $ P(1 \leq Y, \leq 5) = 0.4$

\tab iii.  $ P(C=0) = 0.3$

You need to specify the value of $ P(X = x, Y = y, C = c) $. How many relevant values exist?\\

\pagebreak

$ A \sim B(1, \frac{6}{7}) $

$ B \sim B(1, \frac{4}{7}) $

$ X = 5 + CA $

$ Y = 6 - CB $

$ C \sim B(1, 0.7) $ \\
 
Relevant values for when $ C = 1 $:

\begin{table}[]
\begin{tabular}{|l|l|l|l|}
\hline
\textbf{C = 1}    & \textbf{X = 5} & \textbf{X = 6} & \textbf{P(Y=k)} \\ \hline
\textbf{Y = 5}    & 0.057          & 0.343          & 0.4             \\ \hline
\textbf{Y = 6}    & 0.043          & 0.257          & 0.3             \\ \hline
\textbf{P(X = k)} & 0.1            & 0.6            & 0.7             \\ \hline
\end{tabular}
\end{table}

$ P(X=x,Y=y,C=1) $

$ = P(5 + X = x \mid C = 1)P(6 - Y = y \mid C = 1)P(C = 1) $

$ = P(X = x - 5 \mid C = 1) \cdot P(Y = 6 - y \mid C = 1) \cdot 0.7 $

$ = \binom{1}{x - 5}\frac{6}{7}^{x-5}\frac{1}{7}^{1-(x-5)} \binom{1}{6 - y}\frac{4}{7}^{6 - y}\frac{3}{7}^{1-(6 - y)} \cdot 0.7 $

$ = \frac{6}{7}^{x-5}\frac{1}{7}^{1-x+5} \frac{4}{7}^{6 - y}\frac{3}{7}^{1 - 6 + y} \cdot 0.7 $

$ = \frac{6}{7}^{x-5}\frac{1}{7}^{6-x} \frac{4}{7}^{6 - y}\frac{3}{7}^{y - 5} \cdot 0.7 $

$ = \frac{6^{x-5}}{7}4^{6 - y}\frac{3^{y - 5}}{7} \cdot \frac{7}{10} $

$ = 6^{x-5} \cdot 4^{6 - y} \cdot 3^{y - 5} \cdot \frac{1}{70} $
$ = 2^{x-5+12-2y} \cdot 3^{x + y - 10} \cdot \frac{1}{70} $

$ = 2^{x-2y+7} \cdot 3^{x + y - 10} \cdot \frac{1}{70} $

For the values of $ x = 5,6 $ and $ y = 5,6 $ \\

When $ C = 0 $, the only relevant values are when $ X = 5, Y = 6 $, for which:

$ P(X = 5, Y = 6, C = 0) = P(X = 5 \mid C = 0)P(Y = 6 \mid C = 0)P(C = 0) $

$ = 1 \cdot 1 \cdot 0.3 = 0.3 $

\newpage

\begin{center}
\section*{Question 4}
\end{center}

The probability of Wolt arriving on time is 0.75.

\subsection*{a.} 

What is the probability of having 2 on-time meals in a week (7 days)?

$ X \sim B(7, 0.75) $

$ P(X=2) = \binom{7}{2} \cdot 0.75^2 \cdot(1-0.75)^{7-2} = \binom{7}{2} \cdot 0.75^2 \cdot 0.25^5 = 21 \cdot 0.5625 \cdot 0.000976 = 0.01154 $

\subsection*{b.}

What is the probability of having at least 4 on-time meals in a week? \\

$ P(X \geq 4) =  1 - P(X \leq 3) = 1 - 0.07056 = 0.92944$ 

\subsection*{c.}

\tab A company of 100 employees recorded the number of on-time meals they had during a particular week and averaged their results. What do you expect the value of that average to be? \\

Let $X_i \sim B(7, 0.75) $, \\

$Y = \sum_{i=1}^{100} X_i \sim B(7* 100, 0.75) $\\

Now we take the average as follows: \\

$E(\dfrac{Y}{100}) \stackrel{linearity}{=} \dfrac{E(Y)}{100} \stackrel{\text{binomial formula}}{=} \dfrac{7*100*0.75}{100}  = 5.25 $

    
\end{document}